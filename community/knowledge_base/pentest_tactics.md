# Penetration Testing Tactics & Techniques Guide

This document outlines common tactics, techniques, and procedures (TTPs) used during ethical penetration testing engagements. It serves as a reference for both human testers using Devin and potentially as knowledge for Devin itself. Please contribute and refine these sections!

**Ethical Considerations:** All activities described must be performed only on systems for which you have explicit, written authorization. Adhere strictly to the rules of engagement.

---

## Phase 1: Reconnaissance (Information Gathering)

The goal is to gather as much information as possible about the target organization and infrastructure passively and actively.

### 1.1 Passive Reconnaissance (OSINT - Open Source Intelligence)

* **Domain & IP Information:**
    * Use `whois [domain]` to find registration details.
    * DNS enumeration: `dig any [domain]`, `dnsrecon -d [domain]`, sublist3r, amass.
    * Check certificate transparency logs (e.g., crt.sh).
    * Find related domains/subdomains via search engines (`site:*.target.com`), historical DNS records.
* **Company & Employee Information:**
    * LinkedIn, company website ("About Us", "Careers").
    * Search engines for employee names, email formats (`firstname.lastname@target.com`).
    * Tools like `theHarvester` or Hunter.io.
    * Check breached data repositories (use ethically and legally).
* **Technology Stack Identification:**
    * Analyze job postings for technologies used.
    * Use browser extensions like Wappalyzer or builtwith.com.
    * Examine HTTP headers (`Server`, `X-Powered-By`) and HTML source code.
* **Code Repositories:**
    * Search GitHub, GitLab, Bitbucket for public code related to the target. Look for leaked credentials or sensitive info (use tools like `git-secrets` or TruffleHog conceptually).

### 1.2 Active Reconnaissance

* **Port Scanning:**
    * Identify live hosts: `nmap -sn [target_cidr]` or `ping`.
    * Scan common ports: `nmap -sV -T4 [target_ip]` (Service version detection).
    * Full port scan (slower): `nmap -p- -sV [target_ip]`.
    * UDP scanning (very slow): `nmap -sU [target_ip]`.
    * Example command: `nmap -p- -sV -sC -oN nmap_full.txt [target_ip]` (Full scan, version detect, default scripts, output to file).
* **Web Server Analysis:**
    * Directory/File brute-forcing: `dirb`, `gobuster`, `ffuf`.
        ```bash
        gobuster dir -u http://[target_ip]/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt,html
        ```
    * Virtual Host scanning (if applicable).
    * Analyze `robots.txt` and `sitemap.xml`.
    * Use `nikto -h [target_url]` for basic web server vulnerabilities.
    * Manual inspection with browser developer tools.

---

## Phase 2: Scanning & Enumeration

Identify specific vulnerabilities, running services, user accounts, and configurations.

### 2.1 Vulnerability Scanning

* Use automated scanners like Nessus, OpenVAS, or Nikto (as mentioned above).
* Target specific services based on port scan results (e.g., scan web apps with Burp Suite / ZAP, check SMB versions).
* Example: `nessuscli scan run --targets [target_ip] --policy "Basic Network Scan"` (Conceptual CLI).

### 2.2 Service Enumeration

* **SMB/NetBIOS:** `enum4linux [target_ip]`, `nbtscan [target_cidr]`, `smbclient -L //[target_ip]`. Check for null sessions, list shares, users.
* **NFS:** `showmount -e [target_ip]`. Check mountable shares and permissions.
* **SMTP:** `VRFY`, `EXPN` commands (often disabled). `smtp-user-enum`.
* **SNMP:** `snmpwalk -v2c -c public [target_ip]` (using common community string 'public'). Look for sensitive information.
* **Web Services:** Further directory brute-forcing, API endpoint discovery, technology fingerprinting (frameworks, CMS).
* **Databases:** Check default credentials, version vulnerabilities (requires identifying DB port).

### 2.3 User Enumeration

* From OSINT findings.
* Via service enumeration (SMB, SMTP).
* Potential username guessing/brute-force on login portals (use ethically).

---

## Phase 3: Gaining Initial Access

Exploit identified vulnerabilities or weaknesses to gain a foothold on a target system.

### 3.1 Exploitation

* Use Metasploit Framework (`msfconsole`) to search (`search [cve/service]`) and use known exploits (`use exploit/...`, `set RHOSTS`, `run`).
* Search Exploit-DB or other resources for public exploits.
* Manually exploit common web vulnerabilities (SQLi, XSS, LFI/RFI, Command Injection, SSRF). Requires tools like Burp Suite.
* Misconfiguration Exploitation (e.g., default credentials, exposed management interfaces, insecure file permissions).

### 3.2 Password Attacks

* Brute-force attacks (e.g., using Hydra) against login portals (SSH, FTP, Web login). **Warning:** Can cause lockouts. Adhere to rules of engagement.
    ```bash
    hydra -L users.txt -P /usr/share/wordlists/rockyou.txt ssh://[target_ip]
    ```
* Password spraying (trying common passwords like 'Password123', 'Summer2024' against many usernames).
* Credential stuffing (using breached credentials found during OSINT).

### 3.3 Phishing / Social Engineering

* *Generally out of scope for network/app pentests unless explicitly allowed.* Requires careful planning and authorization.

---

## Phase 4: Privilege Escalation

Once initial access is gained (often as a low-privileged user), attempt to gain higher privileges (e.g., root or Administrator).

### 4.1 Linux Privilege Escalation

* **Kernel Exploits:** Check OS version (`uname -a`) and search for kernel exploits (less common on patched systems).
* **SUID/GUID Binaries:** Find misconfigured binaries: `find / -perm -u=s -type f 2>/dev/null`. Exploit known vulnerable binaries (e.g., `nmap`, `find`, `vim`). See GTFOBins.
* **Insecure File Permissions:** Check `/etc/passwd`, `/etc/shadow` readability (rare), writable scripts run by root, writable service binaries.
* **Cron Jobs:** Check world-writable scripts run by root cron jobs (`ls -l /etc/cron.*`).
* **Service Exploitation:** Vulnerable services running as root. Misconfigured sudo (`sudo -l`).
* **Password Reuse/Weak Passwords:** Check user command history, config files for plaintext passwords.
* **Automated Scripts:** LinPEAS (`linpeas.sh`), LinEnum (`LinEnum.sh`).

### 4.2 Windows Privilege Escalation

* **Missing Patches:** Use `systeminfo` or tools like `winPEAS.exe`, `Sherlock.ps1`, `Watson.exe` to identify missing patches and search for corresponding exploits (e.g., EternalBlue variants if unpatched).
* **Unquoted Service Paths:** Check `wmic service get name,pathname,startmode | findstr /i "auto" | findstr /i /v """`. If path is unquoted and writable, place malicious executable.
* **Insecure Service Permissions:** Use `accesschk.exe` (Sysinternals) or `sc sdshow [ServiceName]` to check if user can modify service binaries or configurations.
* **DLL Hijacking:** Identify applications loading DLLs from writable paths.
* **Stored Credentials:** Check Credential Manager, browser saved passwords, configuration files. Tools like `Mimikatz` (requires high privilege often, use ethically).
* **AlwaysInstallElevated:** Check registry keys if MSI installers run with system privileges.
* **Automated Scripts:** WinPEAS (`winPEAS.exe`), PowerUp (`PowerUp.ps1`), Seatbelt (`Seatbelt.exe`).

---

## Phase 5: Post-Exploitation & Lateral Movement

Actions taken after gaining privileged access, including maintaining access, exploring the network, and moving to other systems.

* **Persistence:** Creating scheduled tasks, services, run keys, SSH keys, backdoor accounts.
* **Information Gathering (Internal):** Network scanning (`nmap` from compromised host), Active Directory enumeration (BloodHound, PowerView), credential dumping (`Mimikatz`, `/etc/shadow`).
* **Lateral Movement:** Pass-the-Hash/Ticket (Windows AD), exploiting trust relationships, using compromised credentials on other systems (SSH, RDP, WinRM), exploiting network service vulnerabilities found internally.
* **Data Exfiltration:** Identifying and extracting sensitive data (use secure channels, often requires specific tooling).

---

## Phase 6: Reporting & Remediation

Document findings, impact, and recommendations clearly.

* **Executive Summary:** High-level overview for management.
* **Technical Details:** Vulnerability descriptions, reproduction steps, evidence (screenshots, logs).
* **Risk Assessment:** Likelihood and impact assessment for each finding.
* **Remediation Recommendations:** Clear, actionable steps to fix vulnerabilities.
* **Appendices:** Raw tool output, scripts used.

---

*This guide provides a general overview. Specific TTPs depend heavily on the target environment and the rules of engagement. Always operate legally and ethically.*
